{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport axios from 'axios';\n\nconst gallery = document.querySelector('.gallery-container');\nconst form = document.querySelector('.form');\nconst input = form.querySelector('.input-search');\nconst searchBtn = form.querySelector('.btn-search');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.btn-load-more');\n\nlet query = '';\nlet page = 1;\nconst per_page = 40;\nlet maxPage = 0;\n\nconst lightbox = new SimpleLightbox('.gallery-link', {\n  captions: true,\n  captionSelector: 'img',\n  captionDelay: 250,\n  captionPosition: 'bottom',\n  captionsData: 'alt',\n});\n\nform.addEventListener('submit', imageSearch);\n\nasync function imageSearch(e) {\n  e.preventDefault();\n\n  gallery.innerHTML = '';\n  loader.classList.add('show');\n  searchBtn.disabled = true;\n  loadMoreBtn.classList.add('is-hidden');\n\n  const toast = document.querySelector('.iziToast');\n  if (toast) {\n    iziToast.hide(\n      {\n        transitionOut: 'fadeOutUp',\n      },\n      toast\n    );\n  }\n\n  query = input.value.trim();\n\n  if (!query) {\n    return;\n  }\n\n  try {\n    const { hits, totalHits } = await fetchImages(query);\n\n    maxPage = Math.ceil(totalHits / per_page);\n\n    renderImages(hits);\n\n    if (hits.length && hits.length !== totalHits) {\n      updateModal();\n\n      loadMoreBtn.classList.remove('is-hidden');\n      loadMoreBtn.addEventListener('click', loadMore);\n    } else if (!hits.length) {\n      iziToast.show({\n        message: `Sorry, there are no images matching your search query. Please, try again!`,\n        messageColor: '#FAFAFB',\n        messageSize: '16px',\n        messageLineHeight: '24px',\n        color: '#EF4040',\n        progressBarColor: '#B51B1B',\n        position: 'topRight',\n        icon: 'icon-cancel',\n        iconColor: '#FAFAFB',\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    loader.classList.remove('show');\n\n    form.reset();\n\n    searchBtn.disabled = false;\n  }\n}\n\nasync function fetchImages(searchWord) {\n  const params = {\n    key: '41767472-d86fe691fef3335ff5b770a4f',\n    q: `${searchWord}`,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page,\n  };\n\n  const url = `https://pixabay.com/api/`;\n\n  return axios.get(`${url}`, { params }).then(({ data }) => data);\n}\n\nfunction renderImages(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n            <li class=\"gallery-item\">\n                <a href=\"${largeImageURL}\" class=\"gallery-link\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" data-source=\"${largeImageURL}\">\n                </a>\n                \n                <ul class=\"gallery-info-container\">\n                    <li class=\"gallery-info\">\n                        <p class=\"gallery-info-name\">Likes</p>\n                        <p class=\"gallery-info-value\">${likes}</p>\n                    </li>\n\n                    <li class=\"gallery-info\">\n                        <p class=\"gallery-info-name\">Views</p>\n                        <p class=\"gallery-info-value\">${views}</p>\n                    </li>\n\n                    <li class=\"gallery-info\">\n                        <p class=\"gallery-info-name\">Comments</p>\n                        <p class=\"gallery-info-value\">${comments}</p>\n                    </li>\n\n                    <li class=\"gallery-info\">\n                        <p class=\"gallery-info-name\">Downloads</p>\n                        <p class=\"gallery-info-value\">${downloads}</p>\n                    </li>\n                </ul>\n            </li>\n      `;\n      }\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n}\n\nfunction updateModal() {\n  lightbox.refresh();\n}\n\nasync function loadMore() {\n  page += 1;\n\n  loader.classList.add('show');\n  loadMoreBtn.classList.add('is-hidden');\n\n  try {\n    const { hits } = await fetchImages(query);\n\n    renderImages(hits);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    if (page === maxPage) {\n      loadMoreBtn.removeEventListener('click', loadMore);\n    } else {\n      loadMoreBtn.classList.remove('is-hidden');\n    }\n\n    loader.classList.remove('show');\n  }\n}\n"],"names":["gallery","form","input","searchBtn","loader","loadMoreBtn","query","page","per_page","maxPage","lightbox","SimpleLightbox","imageSearch","e","toast","iziToast","hits","totalHits","fetchImages","renderImages","updateModal","loadMore","error","searchWord","params","url","axios","data","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"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"}